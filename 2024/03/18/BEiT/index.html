<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/YoungBlogs/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/YoungBlogs/images/Icon.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/YoungBlogs/images/Icon.jpg">
  <link rel="mask-icon" href="/YoungBlogs/images/logo.svg" color="#222">

<link rel="stylesheet" href="/YoungBlogs/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"young-eng.github.io","root":"/YoungBlogs/","images":"/YoungBlogs/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/YoungBlogs/js/config.js"></script>

    <meta name="description" content="BEiT: BERT Pre-Training of Image Transformers[1]  论文的作者是来自哈工大和微软的Hangbo Bao, Li Dong, Songhao Piao 和 Furu Wei。论文引用：Bao, Hangbo et al. “BEiT: BERT Pre-Training of Image Transformers.” ArXiv abs&#x2F;21">
<meta property="og:type" content="article">
<meta property="og:title" content="BEiT">
<meta property="og:url" content="https://young-eng.github.io/YoungBlogs/2024/03/18/BEiT/index.html">
<meta property="og:site_name" content="Young&#39;s Blog">
<meta property="og:description" content="BEiT: BERT Pre-Training of Image Transformers[1]  论文的作者是来自哈工大和微软的Hangbo Bao, Li Dong, Songhao Piao 和 Furu Wei。论文引用：Bao, Hangbo et al. “BEiT: BERT Pre-Training of Image Transformers.” ArXiv abs&#x2F;21">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-03-18T02:10:47.000Z">
<meta property="article:modified_time" content="2024-04-07T01:45:10.000Z">
<meta property="article:author" content="Young">
<meta property="article:tag" content="Self-supervised">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://young-eng.github.io/YoungBlogs/2024/03/18/BEiT/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://young-eng.github.io/YoungBlogs/2024/03/18/BEiT/","path":"2024/03/18/BEiT/","title":"BEiT"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>BEiT | Young's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/YoungBlogs/css/noscript.css">
  </noscript>
<link rel="alternate" href="/YoungBlogs/atom.xml" title="Young's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/YoungBlogs/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Young's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/YoungBlogs/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/YoungBlogs/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/YoungBlogs/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/YoungBlogs/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/YoungBlogs/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#beit-bert-pre-training-of-image-transformers1"><span class="nav-number">1.</span> <span class="nav-text">BEiT: BERT
Pre-Training of Image Transformers[1]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#time"><span class="nav-number">2.</span> <span class="nav-text">Time</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#key-words"><span class="nav-number">3.</span> <span class="nav-text">Key Words</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%92%88%E5%AF%B9%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">4.</span> <span class="nav-text">针对的问题</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Young"
      src="/YoungBlogs/images/Avatar1.png">
  <p class="site-author-name" itemprop="name">Young</p>
  <div class="site-description" itemprop="description">记录学习和生活</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/YoungBlogs/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/YoungBlogs/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/YoungBlogs/tags/">
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Young-eng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Young-eng" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yuen201718@163.com" title="Email → mailto:yuen201718@163.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>Email</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://young-eng.github.io/YoungBlogs/2024/03/18/BEiT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/YoungBlogs/images/Avatar1.png">
      <meta itemprop="name" content="Young">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Young's Blog">
      <meta itemprop="description" content="记录学习和生活">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="BEiT | Young's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          BEiT
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-03-18 10:10:47" itemprop="dateCreated datePublished" datetime="2024-03-18T10:10:47+08:00">2024-03-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-07 09:45:10" itemprop="dateModified" datetime="2024-04-07T09:45:10+08:00">2024-04-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/YoungBlogs/categories/Papers/" itemprop="url" rel="index"><span itemprop="name">Papers</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>923</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h3 id="beit-bert-pre-training-of-image-transformers1">BEiT: BERT
Pre-Training of Image Transformers<sup>[1]</sup></h3>
<blockquote>
<p>论文的作者是来自哈工大和微软的Hangbo Bao, Li Dong, Songhao Piao 和
Furu Wei。论文引用：Bao, Hangbo et al. “BEiT: BERT Pre-Training of Image
Transformers.” ArXiv abs/2106.08254 (2021): n. pag.</p>
</blockquote>
<h3 id="time">Time</h3>
<ul>
<li>2021.Jun</li>
</ul>
<h3 id="key-words"><strong><em>Key Words</em></strong></h3>
<ul>
<li>Self-supervised vision representation model:BEiT</li>
<li>pre-training task: masked image modeling(MIM)</li>
<li>two views of image representation: image patches(input) and visual
tokens(output)</li>
</ul>
<h3 id="针对的问题">针对的问题</h3>
<ol type="1">
<li><p>直接将BERT的思路用于image data有挑战：</p>
<ul>
<li>there is no pre-exist vocabulary for ViT's input unit,i.e. image
patches.所以不能简单地用一个softmax分类器来预测所有可能的masked
patches的candidates.</li>
<li>一个直接的思路是将任务视为回归问题，预测masked patches的raw
pixels，然后pixel-level 的恢复任务tends to waster modeling capability on
pre-training shortrange dependencies and high-frequency details.
<span id="more"></span> ### 总结</li>
</ul></li>
<li><p>BEiT: Bidirectional Encoder representation from Image
Transformers following BERT. In order to solve the data-hungry issue,
self-supervrised have been explored for vision Transformers, such as
contrastive learning and self-distillation. Proposed pre-training task,
namely, masked image modeling(MIM)</p></li>
<li><p>split image into a grid of patches that are the input
representation of backbone Transformer. Moreover, tokenize the image
into discrete visual tokens, which is obtained by the latent codes of
discrete VAE. 在预训练的时候，随机对一些image
patches进行mask，将corrupted input
给到Transformer，模型从学习恢复原始图像的visual
tokens，<strong><em>而不是 masked patches的raw
pixels</em></strong>，这一点和MAE_st不同，MAE_st是恢复raw
pixels，像素级的重建。</p></li>
<li><p>执行自监督学习，自监督学习的时候<strong><em>不需要labels</em></strong>，然后在两个下游任务上--图像分类、语义分割--对预训练的BEiT模型进行微调。</p></li>
<li><p>BEiT能够通过预训练学习reasonable语义区域，unleashing丰富的包含在图像中的监督信号。</p></li>
<li><p>Contributions:</p>
<ul>
<li>提出了MIM用自监督的方式来预训练ViT，从VAE的角度提供了理论解释</li>
<li>预训练BEiT，在下游任务做了很多fine-tuning的实验</li>
<li>提出了BEiT的自注意力机制，来区别语义区域和目标边界，不需要人类的标注。</li>
</ul></li>
<li><p>Visual Tokenizer: tokenize the image <span
class="math inline">\(x\)</span> into <span
class="math inline">\(z\)</span>, vocabulary <span
class="math inline">\(v\)</span> contains discrete token indices.
discrete variational autoencoder(dVAE)'s two modules: tokenizer,
decoder.</p>
<ul>
<li>tokenizer maps image pixels <span class="math inline">\(x\)</span>
into discrete tokens <span class="math inline">\(z\)</span> according to
visual codebook(vocabulary)</li>
<li>decoder基于visual tokens <span class="math inline">\(z\)</span>
重建输入图像<span class="math inline">\(x\)</span>，</li>
<li>同一幅图像里的visual tokens和image patches的数量是相同的，vocabulary
size is <span class="math inline">\(|v| = 8192\)</span>.</li>
</ul></li>
<li><p>randomly mask approximately <span
class="math inline">\(40\%\)</span> image patches,最后的hidden vectors
<span class="math inline">\(h^L_i\)</span> 作为输入patches的encoded
representation， 对于每个masked position,
用一个Softmax分类器来预测对应的visual
tokens。预训练的目标是最大化给定的corrupted image的visual
tokens的log-likelihood: <span
class="math display">\[\max\sum_{x\in\mathcal{D}}\mathbb{E}_\mathcal{M}\left[\sum_{i\in\mathcal{M}}\log
p_\mathrm{MIM}(z_i|x^\mathcal{M})\right]\]</span></p></li>
<li><p>用blockwise masking而不是随机的masking。pixel-level
auto-encoding会使模型聚焦于short-range dependencies和high-frequency
details.BEiT 通过预测离散的visual tokens克服了以上的问题。</p></li>
<li><p>BEiT pretraining: <span
class="math display">\[\sum_{(x_i,\tilde{x}_i)\in\mathcal{D}}(\underbrace{\mathbb{E}_{z_i\sim
q_\phi(z|x_i)}[\log p_\psi(x_i|z_i)]}_{\text{Stage l: Visual Token
Reconstruclion}}+\underbrace{\log
p_\theta(\hat{z}_i|\tilde{x}_i)}_{\text{Stage 2: Masked Image
Modeling}})\]</span></p></li>
<li><p>下游任务：</p></li>
</ol>
<p>在预训练BEiT之后，在Transformer上加一个task
layer，在下游任务上fine-tune参数。 -
图像分类：汇聚完representations之后，用一个softmax分类器。 -
语义分割：follow task layer used in SETR-PUP</p>
<ol start="11" type="1">
<li>self-attention mechanism in BEiT can seperate objects.</li>
</ol>
<p><img
src="https://d3i71xaburhd42.cloudfront.net/722ad6ac92286507437b31486f47987d6ece05c9/2-Figure1-1.png"
alt="BEiT" /> Figure 1<sup>[1]</sup>: Overview of BEIT pre-training.
Before pre-training, we learn an “image tokenizer” via
autoencoding-style reconstruction, where an image is tokenized into
discrete visual tokens according to the learned vocabulary. During
pre-training, each image has two views, i.e., image patches, and visual
tokens. We randomly mask some proportion of image patches (gray patches
in the figure) and replace them with a special mask embedding [M]. Then
the patches are fed to a backbone vision Transformer. The pre-training
task aims at predicting the visual tokens of the original image based on
the encoding vectors of the corrupted image</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/YoungBlogs/tags/Self-supervised/" rel="tag"># Self-supervised</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/YoungBlogs/2024/03/13/MAEasSpatiotemporalLearner/" rel="prev" title="MAE as Spatiotemporal Learner">
                  <i class="fa fa-angle-left"></i> MAE as Spatiotemporal Learner
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/YoungBlogs/2024/03/22/%E9%97%AA%E7%8E%B0%E7%9A%84%E6%83%B3%E6%B3%95/" rel="next" title="闪现的想法">
                  闪现的想法 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-user"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Young</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">69k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">4:10</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="100" alpha="0.6" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/YoungBlogs/js/comments.js"></script><script src="/YoungBlogs/js/utils.js"></script><script src="/YoungBlogs/js/motion.js"></script><script src="/YoungBlogs/js/next-boot.js"></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/YoungBlogs/js/third-party/math/mathjax.js"></script>



</body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/YoungBlogs/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/YoungBlogs/images/Icon.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/YoungBlogs/images/Icon.jpg">
  <link rel="mask-icon" href="/YoungBlogs/images/logo.svg" color="#222">

<link rel="stylesheet" href="/YoungBlogs/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"young-eng.github.io","root":"/YoungBlogs/","images":"/YoungBlogs/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/YoungBlogs/js/config.js"></script>

    <meta name="description" content="MViTv2: Improved Multiscale Vision Transformers for Classification and Detection[1]  作者和MViT一样，是来自FAIR和UC Berkeley的Yang hao Li, Chao-Yuan Wu等人。论文引用[1]:Li, Yanghao et al. “MViTv2: Improved Multisc">
<meta property="og:type" content="article">
<meta property="og:title" content="MViTv2">
<meta property="og:url" content="https://young-eng.github.io/YoungBlogs/2024/09/20/MViTv2/index.html">
<meta property="og:site_name" content="Young&#39;s Blog">
<meta property="og:description" content="MViTv2: Improved Multiscale Vision Transformers for Classification and Detection[1]  作者和MViT一样，是来自FAIR和UC Berkeley的Yang hao Li, Chao-Yuan Wu等人。论文引用[1]:Li, Yanghao et al. “MViTv2: Improved Multisc">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-09-20T02:36:18.000Z">
<meta property="article:modified_time" content="2024-09-20T14:37:15.979Z">
<meta property="article:author" content="Young">
<meta property="article:tag" content="Vision Transformer">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://young-eng.github.io/YoungBlogs/2024/09/20/MViTv2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://young-eng.github.io/YoungBlogs/2024/09/20/MViTv2/","path":"2024/09/20/MViTv2/","title":"MViTv2"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MViTv2 | Young's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/YoungBlogs/css/noscript.css">
  </noscript>
<link rel="alternate" href="/YoungBlogs/atom.xml" title="Young's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/YoungBlogs/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Young's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/YoungBlogs/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/YoungBlogs/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/YoungBlogs/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/YoungBlogs/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/YoungBlogs/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#mvitv2-improved-multiscale-vision-transformers-for-classification-and-detection1"><span class="nav-number">1.</span> <span class="nav-text">MViTv2:
Improved Multiscale Vision Transformers for Classification and
Detection[1]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#time"><span class="nav-number">2.</span> <span class="nav-text">Time</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#key-words"><span class="nav-number">3.</span> <span class="nav-text">Key Words</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">4.</span> <span class="nav-text">总结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Young"
      src="/YoungBlogs/images/Avatar1.png">
  <p class="site-author-name" itemprop="name">Young</p>
  <div class="site-description" itemprop="description">记录学习和生活</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/YoungBlogs/archives/">
          <span class="site-state-item-count">89</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/YoungBlogs/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/YoungBlogs/tags/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Young-eng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Young-eng" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yuen201718@163.com" title="Email → mailto:yuen201718@163.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>Email</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://young-eng.github.io/YoungBlogs/2024/09/20/MViTv2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/YoungBlogs/images/Avatar1.png">
      <meta itemprop="name" content="Young">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Young's Blog">
      <meta itemprop="description" content="记录学习和生活">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MViTv2 | Young's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MViTv2
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-09-20 10:36:18 / 修改时间：22:37:15" itemprop="dateCreated datePublished" datetime="2024-09-20T10:36:18+08:00">2024-09-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/YoungBlogs/categories/Papers/" itemprop="url" rel="index"><span itemprop="name">Papers</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h3
id="mvitv2-improved-multiscale-vision-transformers-for-classification-and-detection1">MViTv2:
Improved Multiscale Vision Transformers for Classification and
Detection<sup>[1]</sup></h3>
<blockquote>
<p>作者和MViT一样，是来自FAIR和UC Berkeley的Yang hao Li, Chao-Yuan
Wu等人。论文引用[1]:Li, Yanghao et al. “MViTv2: Improved Multiscale
Vision Transformers for Classification and Detection.” 2022 IEEE/CVF
Conference on Computer Vision and Pattern Recognition (CVPR) (2021):
4794-4804.</p>
</blockquote>
<h3 id="time">Time</h3>
<ul>
<li>2021.Dec</li>
</ul>
<h3 id="key-words">Key Words</h3>
<ul>
<li>MViT that incorporates decomposed relative positional embeddings and
residual pooling connections. <span id="more"></span></li>
</ul>
<h3 id="总结">总结</h3>
<ol type="1">
<li>ViT用于高分辨率的object detection和space-time video understanding
tasks仍然具有挑战。<strong>密集的visual signals 在计算和memory
requirements上提出了挑战，因为在Transformer-based model中，scale
quadratically in complexity within the self-attention
blocks</strong>。大家有不同的策略来解决这个问题：
<ul>
<li><font color=red>local attention computation within a window for
object detection</font></li>
<li><font color=red>pooling attention that locally aggregates features
before computing self-attention in video tasks</font>.
MViT就是采用的后者，不同于ViT：ViT的整个网络是一个固定的resolution,
MViT是一个feature hierarchy with multiple stages starting from
high-resolution to low-resolution.</li>
</ul></li>
<li>MViTv2在MViT的基础上，做了几点改进：
<ul>
<li><strong>通过提高pooling attention along two axes</strong>:
<ul>
<li>shift-invariant positional embeddings using <em>decomposed</em>
location distances to inject position information in Transformer
blocks</li>
<li>a residual pooling connection to compensate the effect of pooling
strides in attention computation.</li>
</ul></li>
<li>采用standard dense prediction framework: Mask RCNN with FPN, using
improved structure of MViT, apply it to object detection and instance
segmentation. 作者研究MViT是否能通过 <strong>pooling attention</strong>
来克服computation和memory cost, 来处理high-resolution visual input.
实验表明：<strong>pooling attention is more effective than local window
attention mechanisms</strong>, 进一步develop了一个
<em>simple-yet-effective Hybrid window attention</em>,
能够<strong>complement pooling attention for better accuracy/compute
tradeoff</strong>.</li>
</ul></li>
<li>Improved Multiscale Vision Transformers.
<ul>
<li><p><strong>Improved Pooling Attention</strong>：</p>
<ul>
<li><strong>Decomposed Relative Positional Embeddings</strong>: MViT
展示了model
tokens之间的interaction的能力，它们关注content，而不是structure，space-time
structure建模仅依赖于<em>absolute postional
embedding</em>，来提供<font color=red>location
information</font>。这个忽略了<strong>shift-invariance in
vision</strong>的基本原则。<strong>也就是说：MViT对两个patches之间的interaction的建模会根据它们的绝对位置而变化，即使它们的relative
positions保持不变</strong>。为了解决这个问题，把仅依赖于tokens之间的相对location
distance的相对位置嵌入，与pooled self-attention
computation相结合。将relative position between two input elements,
<em>i</em> and <em>j</em> 编码到 positional embedding <span
class="math inline">\(R_{p(i),p(j)}\in\mathbb{R}^d,\)</span> <span
class="math inline">\(p(i),p(j)\)</span> 表示 element <em>i</em> 和
<em>j</em>的 spatial position，这个成对的 encoding representation
然后被嵌入到 self-attention module之中。 <span
class="math display">\[\mathrm{Attn}(Q,K,V)=\mathrm{Softmax}\left((QK^{\top}+E^{(\mathrm{rel})})/\sqrt{d}\right)V,\\\mathrm{where}\quad
E_{ij}^{(\mathrm{rel})}=Q_{i}\cdot
R_{p(i),p(j)}.\text{(3)}\]</span></li>
</ul>
<p>然而，可能的embeddings的数量 <span
class="math inline">\(R_{p(i),p(j)}\)</span> scale in <span
class="math inline">\(O(TWH)\)</span>，计算比较expensive，为了减小complexity，将element
<em>i</em> 和 <em>j</em>之间的 distance computation 在spatiotemporal
axes方向上进行 decompose， <span
class="math display">\[R_{p(i),p(j)}=R_{h(i),h(j)}^\mathrm{h}+R_{w(i),w(j)}^\mathrm{w}+R_{t(i),t(j)}^\mathrm{t},\]</span></p>
<p><span class="math inline">\(R^h，R^w, R^t\)</span> 分别是height,
width和temporal axes方向上的 positional embeddings，<span
class="math inline">\(h(i), w(i), t(i)\)</span> 分别表示 vertical,
horizontal 和temporal position of token <em>i</em>，注意到 <span
class="math inline">\(R^t\)</span>是一个 optional，在video case中
required，来support temporal dimension。相比之下，decomposed
embeddings将 learned embeddings的数量减小到 <span
class="math inline">\(O(T+W+H)\)</span>，对于early-stage,
high-resolution的feature maps有很大的影响。</p>
<ul>
<li><strong>Residual pooling connection</strong>：pooling attention
对于减小计算复杂度和memory requirements in attention
blocks是非常有效的，MViTv1有很大的strides on <span
class="math inline">\(K\)</span>和 <span
class="math inline">\(V\)</span> tensors than the stride of the <span
class="math inline">\(Q\)</span> tensor,which is only downsampled if the
resolution of the output sequence changes across stages。这个motivates
us 来增加 residual pooling connection with the (pooled)Q
tensor，来增加information flow，促进pooling attention
blocks的训练。引入了一个新的residual pooling connection inside the
attention blocks，增加一个pooled query tensor to output sequence <span
class="math inline">\(Z\)</span>。</li>
</ul></li>
<li><p><strong>MViT for object
detection</strong>：MViT的层次化结构，产生了多尺度的feature maps in four
stages，因此可以很自然地集成到FPN网络里。</p>
<ul>
<li><font color=red>Hybrid window
attention</font>Transformer中的自注意力有quadratic complexity w.r.t the
number of tokens。对于目标检测来说，它有更高分辨率的输入和feature
maps，文章中，研究了两种方式，减小compute 和memory
complexity：首先，pooling attention；第二个是 window attention。 Pooling
attention和window
attention都是用来控制自注意力的复杂度的，通过减小query,key,
value的size，它们的内在本质是不一样的：<strong>Pooling attention pools
features by downsampling them via local aggregation，但是keeps a global
self-attention computation</strong>，然而，<strong>window attention
keeps the resolution of tensors，但是performs self-attention locally by
dividing the input(patchified tokens)into non-overlapping windows，only
compute local self-attention within each
window</strong>。这个内在本质的不同，motivates us to study
它们是否能够在目标检测任务上互补。</li>
</ul>
<p>尽管window attention仅在windows内进行local
self-attention，缺乏跨windows的connections。不同于Swin(用了shifted
windows来减弱这个问题),提出了简单的<em>hybrid window attention</em>
design to add cross-window connections。</p>
<ul>
<li><font color=red>Positional embeddings in
detecition</font>：不同于ImageNet的图像分类，其输入是fixed
resolution，目标检测包括了varying sizes inputs。对于positional
embeddings in MViT(either absolute or relative),
首先从ImageNet预训练的、对应于 <span class="math inline">\(224 \times
224\)</span> input size的positinoal
embeddings的weights进行初始化。然后将它们interpolate到各自的sizes，用于目标检测的训练。</li>
</ul></li>
</ul></li>
</ol>
<p><img
src="https://d3i71xaburhd42.cloudfront.net/9137efc758f80dd22bb56f82cca5c94f78a5db3e/1-Figure1-1.png"
alt="MViTv2" /> <span class="math inline">\(Fig.1^{[1]}\)</span> MViTv2
is a multiscale transformer with state-of-the-art performance across
thres visual recognition tasks.</p>
<p><img
src="https://d3i71xaburhd42.cloudfront.net/9137efc758f80dd22bb56f82cca5c94f78a5db3e/3-Figure2-1.png"
alt="Improved Pooling Attention" /> <span
class="math inline">\(Fig.2^{[1]}\)</span> The improved Pooling
Attention mechanism that incorporating decomposed relative position
embedding, <span class="math inline">\(R_{p(i),p(j)}\)</span>, and
residual pooling connection modules in the attention block.</p>
<p><img
src="https://d3i71xaburhd42.cloudfront.net/9137efc758f80dd22bb56f82cca5c94f78a5db3e/4-Figure3-1.png"
alt="Multiscale MViTv2" /> <span
class="math inline">\(Fig.3^{[1]}\)</span> MViT backbone used with FPN
for object detection. The multiscale transformer features naturally
integrate with standard FPN</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/YoungBlogs/tags/Vision-Transformer/" rel="tag"># Vision Transformer</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/YoungBlogs/2024/09/16/LW-DETR/" rel="prev" title="LW-DETR">
                  <i class="fa fa-angle-left"></i> LW-DETR
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/YoungBlogs/2024/09/23/%E4%BA%BA%E7%B1%BB%E7%BE%A4%E6%98%9F%E9%97%AA%E8%80%80%E6%97%B6/" rel="next" title="人类群星闪耀时">
                  人类群星闪耀时 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-user"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Young</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">77k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">4:41</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="100" alpha="0.6" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/YoungBlogs/js/comments.js"></script><script src="/YoungBlogs/js/utils.js"></script><script src="/YoungBlogs/js/motion.js"></script><script src="/YoungBlogs/js/next-boot.js"></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/YoungBlogs/js/third-party/math/mathjax.js"></script>



</body>
</html>
